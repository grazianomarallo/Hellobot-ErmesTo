{
  "config": {
    "start_state": 0
  },
  "buttons": {

 },
  "states": {
    "0": {
      "instructions": "ğŸ  *Inizio*\n\n Premi su:\nğŸ” CERCA  ğŸ per cercare la mensa piÃ¹ vicina.\nâ„¹ï¸ INFO ğŸ per info piÃ¹ dettagliate\nğŸ“® FEEDBACK per inviarci suggerimenti.",
      "keyboard": [["ğŸ” CERCA  ğŸ", "â„¹ï¸ INFO ğŸ"], ["ğŸ“® FEEDBACK"]],
      "triggers": {
        "text": [
          {
            "input": "ğŸ” CERCA  ğŸ",
            "actions": [
              {
              "action_type": "CHANGE_STATE",
              "action_params": {
                "new_state": 1
                }
              }
            ]
          },
          {
            "input": "â„¹ï¸ INFO ğŸ",
            "actions": [
              {
              "action_type": "CHANGE_STATE",
              "action_params": {
                "new_state": 2
                }
              }
            ]
          },
          {
            "input": "ğŸ“® FEEDBACK",
            "actions": [
              {
                "action_type": "CHANGE_STATE",
                "action_params": {
                  "new_state": 9
                }
              }
            ]
          }
        ]
      }
    },
    "1": {
      "instructions": "Mandami la tua posizione.",
      "triggers": {
        "location": {
          "actions": [
            {
              "action_type": "SEND_MAP",
              "action_params": {
                "url": ""
              }
            },
            {
              "action_type": "CHANGE_STATE",
              "action_params": {
                "new_state": 0
              }
            }
          ]
        }
      }
    },
    "2": {
      "instructions": "Scegli la mensa che ti interessa.",
      "keyboard": "utility.makeArray2D(mensa_info.mensa_names,1)",
      "triggers": {
        "text": [
          {
            "input": "*",
            "validation": "'__user_input__' in flat_kb",
            "actions": [
              {
                "action_type": "SEND_TEXT",
                "action_params": {
                  "text": "mensa_info.getInfoMensa('__user_input__')"
                }
              },
              {
                "action_type": "SAVE_VAR",
                "action_params": {
                  "var_name": "mensa_name",
                  "var_value": "__user_input__"
                }
              },
              {
                "action_type": "CHANGE_STATE",
                "action_params": {
                  "new_state": 4
                }
              }
            ]
          }
        ]
      }
    },
    "4": {
      "instructions": "Scegli tipo di informazione.",
      "keyboard": [["ğŸ  HOME"],["ğŸ“œ MENU", "ğŸ“Š STATS"], ["ğŸ”™ INDIETRO"]],
      "triggers": {
        "text": [
          {
            "input": "ğŸ“œ MENU",
            "actions": [
              {
                "action_type": "SEND_TEXT",
                "action_params": {
                  "load_var_name": "mensa_name",
                  "text": "mensa_info.getMenuInfo('__loaded_var__')"
                }
              }
            ]
          },
          {
            "input": "ğŸ“Š STATS",
            "actions": [
              {
              "action_type": "CHANGE_STATE",
              "action_params": {
                "new_state": 5
                }
              }
            ]
          },
          {
            "input": "ğŸ”™ INDIETRO",
            "actions": [
              {
                "action_type": "CHANGE_STATE",
                "action_params": {
                  "new_state": 2
                }
              }
            ]
          },
          {
            "input": "ğŸ  HOME",
            "actions": [
              {
                "action_type": "RESTART"
              }
            ]
          }
        ]
      }
    },
    "5": {
      "instructions": "*Informazioni affluenza:*\n\n",
      "keyboard": [["ğŸ”™ INDIETRO"]],
      "untriggered_actions": [
        {
          "action_type": "SEND_TEXT",
          "action_params": {
            "text": "rasberry.getPostiOccupati()"
          }
        }
      ],
      "triggers": {
        "text": [
          {
            "input": "ğŸ”™ INDIETRO",
            "actions": [
              {
                "action_type": "CHANGE_STATE",
                "action_params": {
                  "new_state": 4
                }
              }
            ]
          }
        ]
      }
    },
    "9": {
      "instructions": "ğŸ“© Non esitate a *contattarci*:\n\n ğŸ“ Scrivi qua sotto qualsiasi feedback o consiglio",
      "keyboard": [["ğŸ”™ INDIETRO"]],
      "triggers": {
        "text": [
          {
            "input": "ğŸ”™ INDIETRO",
            "actions": [
              {
                "action_type": "RESTART"
              }
            ]
          },
          {
            "input": "*",
            "actions": [
              {
                "action_type": "SEND_TEXT_ADMIN",
                "action_params": {
                  "text": "__user_input__"
                }
              }
            ]
          }
        ]
      }
    }
  }
}